(ns tiltontec.example.x01-counter
  (:require
   ["package:flutter/material.dart" :as m]
   ["package:flutter/painting.dart" :as p]
   [tiltontec.matrix.api :refer [cF cI cFn cFonce mpar mget mset! mswap! fm*] :as mx]
   [tiltontec.flutter-mx.core :as fx
    :refer [as-dart-callback in-my-context
            material-app scaffold app-bar floating-action-button
            center column text sized-box]]))

(def title-message "VOJO by QiMono")
(def message "Shift Left << ")
(defn make-app []
  (material-app
   {:title "Flutter/MX Counter Demo"
    :theme (m/ThemeData .primarySwatch m.Colors/blue)}
   (scaffold
    {:appBar
     (app-bar
      {:title (m/Text title-message)})
     :floatingActionButton
     (cF (floating-action-button
          {:onPressed (as-dart-callback []
                                        (mswap! (fm* :z-counter) :value inc))
           :tooltip   "Increment"}
          (m/Icon m.Icons/add .color m.Colors/black)))}
    (center
     (column {:mainAxisAlignment m.MainAxisAlignment/center}
             (text {:style (p/TextStyle .color m.Colors/blue
                                        .fontSize 20.0)}
                   message)
             (sized-box {:height 14.0})
             (text
              {:style (in-my-context [me ctx]
                                     (.-headline4 (.-textTheme (m.Theme/of ctx))))}
              {:name  :z-counter
               :value (cI 0)}
              (str (mx/my-value))))))))


